// Target the form element
const form = document.getElementById("iamofficerForm");

// Add event listener for form submission
form.addEventListener("submit", function (e) {
  e.preventDefault(); // Prevent the default form submission behavior

  // Collect form data
  const formData = new FormData(form); 
  const jsonData = {}; // Create an empty object to store JSON data

  // Convert FormData to JSON
  formData.forEach((value, key) => {
    jsonData[key] = value;
  });

  // Debugging: Ensure JSON data is being created correctly
  console.log("Form Data as JSON:", jsonData);

  // Fetch request to backend
  fetch("http://localhost:8080/user/iamofficer", {
    method: "POST", // Specify the HTTP method as POST
    headers: {
      "Content-Type": "application/json", // Ensure the server knows we're sending JSON
    },
    body: JSON.stringify(jsonData), // Convert the JSON object to a string for the request body
  })
    .then((response) => {
      // Handle the response status
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json(); // Parse the response as JSON
    })
    .then((data) => {
      // Debugging: Log the server response for verification
      console.log("Server Response:", data);

      // Handle successful login
      if (data.status === 200) {
        alert(data.message); // Optional: Alert user with success message
        window.location.href = "Officer_dashboard.html"; // Redirect to dashboard
      } else {
        // Handle failure (e.g., incorrect email/password)
        alert(data.message); // Show error message from server response
      }
    })
    .catch((error) => {
      // Handle network or other fetch-related errors
      console.error("Error:", error); 
      alert("An error occurred while verifying the user. Please try again.");
    });
});
